## Test Line Diagram: TL105 Jupiter Small Configuration

Configuration repo: Mobile-Phoenix/pws-tl-config

Server hardware connection checking:
XR11 server BIOS setting:
Druid Installed & Configuration:
For this test line, Host Automation team's Druid5.3.2.1 + Druid day0 pb were deployed and Druid role was commented out on deployer pb. 

After Druid installed, send the email to druid support to request the license, the license will be sent to your email by the 2nd day. Load the Druid license to the raemis GUI.

Click System → Apply License → Load the license spreadsheet you get from Druid support.



Access Druid configuration page: http://10.237.170.17:8089  Currently this page can only be accessed through Ottawa RDP, lab team is working on opening this subnet on lab firewall. 

Druid configuration setup for TL105:



Raemis login page can be accessed on: https://10.237.170.17/logon.html 



Create User: Users → Add User







Add SIM card information: Output.yaml for Sample 20 SIM Cards Generated by Thales 



UE configuration:
Refer to Qualcomm documentation

Virtual Interfaces and Dummy interfaces creation:
Currently, the deployer does not support the creation of these interfaces, but efforts are underway to incorporate this functionality into their deployer in order to support the Jupiter solution.

Run gNB deployer:


CU-CP bring up:
SSH to 10.237.170.17 with login using IDM credentials.

Follow below steps to route to the cu-cp directory and bring up the CU.

sudo -i

cd /opt/gnb/cucp/bin

./start_cu_cp

This message indicates the successful CU_UP start:  "Stack Bringup - CU is UP"

If CUCP has not yet applied the configuration, use the following command to do so: 

/data/confd-basic-7.3.3.linux.x86_64/confd/bin/netconf-console --host=10.237.170.17 --port=2102 /opt/gnb/cucp/config/oam_3gpp_cu_cp_sa_1du_1cell.xml

[root@in-xr11-ux-0017 ~]# /data/confd-basic-7.3.3.linux.x86_64/confd/bin/netconf-console --host=10.237.170.17 --port=2102 /opt/gnb/cucp/config/oam_3gpp_cu_cp_sa_1du_1cell.xml
/usr/local/lib/python3.6/site-packages/paramiko/transport.py:33: CryptographyDeprecationWarning: Python 3.6 is no longer supported by the Python core team. Therefore, support for it is deprecated in cryptography. The next release of cryptography will remove support for Python 3.6.
  from cryptography.hazmat.backends import default_backend
/usr/local/lib/python3.6/site-packages/paramiko/transport.py:236: CryptographyDeprecationWarning: Blowfish has been deprecated
  "class": algorithms.Blowfish,
<?xml version="1.0" encoding="UTF-8"?>
<rpc-reply xmlns="urn:ietf:params:xml:ns:netconf:base:1.0" message-id="1">
  <rpc-error>
    <error-type>application</error-type>
    <error-tag>operation-failed</error-tag>
    <error-severity>error</error-severity>
    <error-app-tag>too-many-elements</error-app-tag>
    <error-path xmlns:extgnbcucp3gpp="urn:3gpp:sa5:_3gpp-nr-nrm-externalgnbcucpfunction" xmlns:nrnet3gpp="urn:3gpp:sa5:_3gpp-nr-nrm-nrnetwork">
    /rpc/edit-config/config/nrnet3gpp:NRNetwork[nrnet3gpp:id='0']/extgnbcucp3gpp:ExternalGNBCUCPFunction[extgnbcucp3gpp:id='']/extgnbcucp3gpp:attributes/extgnbcucp3gpp:pLMNId
  </error-path>
    <error-message xml:lang="en">too many /NRNetwork[id='0']/extgnbcucp3gpp:ExternalGNBCUCPFunction[id='']/attributes/pLMNId, 2 configured, at most 1 must be configured</error-message>
    <error-info xmlns:tailf="http://tail-f.com/ns/netconf/params/1.1" xmlns:extgnbcucp3gpp="urn:3gpp:sa5:_3gpp-nr-nrm-externalgnbcucpfunction" xmlns:nrnet3gpp="urn:3gpp:sa5:_3gpp-nr-nrm-nrnetwork">
      <tailf:bad-instance-count>
        <tailf:bad-element>/nrnet3gpp:NRNetwork[nrnet3gpp:id='0']/extgnbcucp3gpp:ExternalGNBCUCPFunction[extgnbcucp3gpp:id='']/extgnbcucp3gpp:attributes/extgnbcucp3gpp:pLMNId</tailf:bad-element>
        <tailf:instances>2</tailf:instances>
        <tailf:max-instances>1</tailf:max-instances>
      </tailf:bad-instance-count>
    </error-info>
  </rpc-error>
</rpc-reply>

CU-UP bring up:
SSH to 10.237.170.18 with login using IDM credentials.

Follow below steps to route to the cu-up directory and bring up.

sudo -i

cd /opt/gnb/cuup/bin

./start_cu_up.tl102  <—currently use Christian edit start_cu_up script, not the one coming from RPM installed.

This message indicates the successful CU_UP start:  "Stack Bringup - CU is UP"

If CUUP has not yet applied the configuration, use the following command to do so: 

source /data/confd-basic-7.3.3.linux.x86_64/confd/confdrc

netconf-console --host=10.237.170.18 --port=2103 /opt/gnb/cuup/config/oam_3gpp_cu_up_sa.xml

[root@in-xr11-ux-0018 bin]# /data/confd-basic-7.3.3.linux.x86_64/confd/bin/netconf-console --host=10.237.170.18 --port=2103 /opt/gnb/cuup/config/oam_3gpp_cu_up_sa.xml
<?xml version="1.0" encoding="UTF-8"?>
<rpc-reply xmlns="urn:ietf:params:xml:ns:netconf:base:1.0" message-id="1">
  <ok/>
</rpc-reply>

DU +M-plane bring up:
SSH to 10.237.170.18 with login using IDM credentials 

Follow below steps to route to the DU directory and bring up the DU bin.

sudo - i

cd /opt/gnb/du_marvell/bin

./start_du_marvell

Open another tab and follow below steps to route to the M-plane directory and bring up the M-plane bin.

cd /opt/gnb/mplane/bin

./start_mplane

NOTE: Wait M-Plane got call home message from RU successfully

[2023/06/15 13:11:11.893189][NETCONF_PROXY][INF][NetconfProxy.cpp:768]ssId: 1 callHomeStatus: NETCONF_CALL_HOME_SUCCESS hostname: 192.168.0.3 port: 4334

[2023/06/15 13:11:11.981971][M_PLANE_STATE_MACHINE][INF][MPlaneStateMachine.cpp:191]SESSION_READY[ruID: FACA_RPQN-7801_M230110615 ][ssId: 1 ]

When we receive call home message from radio, that means radio is ready to take carrier activation now. 

DU is waiting for configuration, cell is not up yet. 

Then, open another tab to apply the DU configuration:

update this RUID: FACA_RPQN-7801_M230110615 to /opt/gnb/du_marvell/config/oam_3gpp_cell_cfg_mu1_1cell.xml

/data/confd-basic-7.3.3.linux.x86_64/confd/bin/netconf-console --host=10.237.170.18 --port=2100 /opt/gnb/du_marvell/config/oam_3gpp_cell_cfg_mu1_1cell.xml

[root@in-xr11-ux-0018 bin]# /data/confd-basic-7.3.3.linux.x86_64/confd/bin/netconf-console --host=10.237.170.18 --port=2100 /opt/gnb/du_marvell/config/oam_3gpp_cell_cfg_mu1_1cell.xml
<?xml version="1.0" encoding="UTF-8"?>
<rpc-reply xmlns="urn:ietf:params:xml:ns:netconf:base:1.0" message-id="1">
  <ok/>
</rpc-reply>



####on DU terminal, the message is showing " Triggering F1 setup Request message...

If DU console shows 'Cell[1] is UP', good to go with UE attach.

CELL[1] is UP
TTI received at APP : 0
#############################################################################################
                       GNB DU Statistics  Thu Jun 15 13:22:36 2023
#############################################################################################
CELL-ID  NUM-UE   SCH-DL  SCH-UL
1        0        0.00    0.00

Total Number of UEs  : 0
         SCH  DL Tpt : 0.00  UL Tpt 0.00
         EGTP DL Tpt : 0.00  UL Tpt 0.00

RU Upgrade: 
Connect RJ45 cable for RU upgrade.

DellRan team has experienced many issues with Foxconn radio, may need to setup interface to get their support.

Foxconn Radio SW download link:

TL105 has returned RU, not the brand new one.

This RU upgrade procedure can also be done via Netconf using mplane. 

Login to control PC: 10.237.93.193

connect to COM8 interface (USB Serial Port: 115200 bps)

Check the radio SW version:

root@arria10:~/test# cat version.txt
b_branch: master
b_commit: ffa6dd30bdfd581dab5b3ac31e1933533d22bf50
s_commit: aa0fbb0efca175b6d281398d9bd0f03423bfb693
m_commit: 2730acf97391d170addececf82fffd4193ee096d
tag: v3.1.12q.551-oam <--------------Need to be on oam version.
build_time: 202304071650

root@arria10:~/test# ./install_eng_v3_1_12q_551_202304071650.run

root@arria10:~/test# ./install_oam_v3_1_12q_551_202304071650.run

Check mplane terminal output, it will show message of "supported authentication methods failed".

Everytime after RU SW upgrade, the password needs to be changed.

root@arria10:~/test# passwd <—use this command to change password to ""root"

root@arria10:~/test# ifconfig
lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

qse-eth   Link encap:Ethernet  HWaddr 6c:ad:ad:00:0a:32
          inet addr:192.168.0.3  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::6ead:adff:fe00:a32/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:2810760 errors:0 dropped:130 overruns:0 frame:0
          TX packets:722786 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:193232360 (184.2 MiB)  TX bytes:46328432 (44.1 MiB)
          Memory:ff224000-ff224fff



check if br0 and br1 are up
br0 is to manage minvera card
br1 is to manage radio

[chenhui_zheng@in-xr11-ux-0018 ~]$ ip -br addr
lo               UNKNOWN        127.0.0.1/8 ::1/128
ens1f0           DOWN
ens1f1           DOWN
eno8303np0       UP             10.237.170.18/24 fe80::ca4b:d6ff:fe91:9b4f/64
ens1f2           DOWN
eno8403np1       UP             fe80::ca4b:d6ff:fe91:9b50/64
ens1f3           DOWN
eno8503np2       DOWN
eno8603np3       DOWN
eno8403v1        UP             10.0.11.32/24 fe80::377a:8c5:7e16:d128/64
eno8403v2        UP             10.0.10.42/24 fe80::39f4:7308:d53:86b0/64
br0                   UP             192.168.1.1/24  <---DHCP, minvera card will get 192.168.1.x
br1                  UP             192.168.0.1/24  <---DHCP, radio will get 192.168.0.x
ens2f0             UP
ens2f0v1         UP
ens2f0v2         UP
ens2f0v3         UP
ens2f0v4         UP



Check if radio is getting DHCP from host

on another teminal, run arp to check br0 minvera interface

[chenhui_zheng@in-xr11-ux-0018 ~]$ arp
Address                  HWtype  HWaddress           Flags Mask            Iface
192.168.1.2              ether   c8:4b:d6:95:56:6d   C                     br0
ausaleachs1mba1.corp.em  ether   6c:ad:ad:00:0a:32   C                     br1
10.0.10.21               ether   82:43:56:9a:6e:e9   C                     eno8403v2
10.237.170.16            ether   c8:4b:d6:91:95:35   C                     eno8303np0
10.237.170.32            ether   30:d0:42:de:e0:ac   C                     eno8303np0
10.237.170.254           ether   00:50:56:8a:77:4f   C                     eno8303np0
10.237.170.2             ether   e8:65:5f:9b:26:fa   C                     eno8303np0
10.0.11.21               ether   ce:ae:22:98:20:dc   C                     eno8403v1
aufnserredm1.corp.emc.c  ether   6c:ad:ad:00:0a:32   C                     br1
10.237.170.31            ether   c8:4b:d6:92:06:d3   C                     eno8303np0
10.237.170.15            ether   c8:4b:d6:91:97:2f   C                     eno8303np0
10.237.170.22            ether   84:16:0c:31:04:6d   C                     eno8303np0
10.237.170.17            ether   c8:4b:d6:91:99:d9   C                     eno8303np0
_gateway                 ether   00:00:5e:00:01:04   C                     eno8303np0
10.237.170.19            ether   d0:8e:79:f2:11:ee   C                     eno8303np0
10.237.170.33            ether   30:d0:42:df:be:f2   C                     eno8303np0
10.237.170.3             ether   e8:65:5f:9b:24:7a   C                     eno8303np0
10.237.170.35            ether   30:d0:42:de:08:2e   C                     eno8303np0



update 2 mac address highlighted to /opt/gnb/du_marvell/config/sysconfig.txt



[root@in-xr11-ux-0018 ~]# lshw -c network -businfo
Bus info          Device      Class          Description
========================================================
pci@0000:18:00.0  ens1f0      network        NetXtreme BCM5719 Gigabit Ethernet PCIe
pci@0000:18:00.1  ens1f1      network        NetXtreme BCM5719 Gigabit Ethernet PCIe
pci@0000:18:00.2  ens1f2      network        NetXtreme BCM5719 Gigabit Ethernet PCIe
pci@0000:18:00.3  ens1f3      network        NetXtreme BCM5719 Gigabit Ethernet PCIe
pci@0000:19:00.0  eno8303np0  network        BCM57504 NetXtreme-E 10Gb/25Gb/40Gb/50Gb/100Gb/200Gb Ethernet
pci@0000:19:00.1  eno8403np1  network        BCM57504 NetXtreme-E 10Gb/25Gb/40Gb/50Gb/100Gb/200Gb Ethernet
pci@0000:19:00.2  eno8503np2  network        BCM57504 NetXtreme-E 10Gb/25Gb/40Gb/50Gb/100Gb/200Gb Ethernet
pci@0000:19:00.3  eno8603np3  network        BCM57504 NetXtreme-E 10Gb/25Gb/40Gb/50Gb/100Gb/200Gb Ethernet
pci@0000:1a:01.0              network        BCM5750X NetXtreme-E Ethernet Virtual Function
pci@0000:1a:01.1  eno8403v1   network        BCM5750X NetXtreme-E Ethernet Virtual Function
pci@0000:1a:01.2  eno8403v2   network        BCM5750X NetXtreme-E Ethernet Virtual Function
pci@0000:51:00.0  ens2f0      network        Cavium, Inc.
pci@0000:51:02.0              network        Cavium, Inc.
pci@0000:51:02.1  ens2f0v1    network        Cavium, Inc.
pci@0000:51:02.2  ens2f0v2    network        Cavium, Inc.
pci@0000:51:02.3  ens2f0v3    network        Cavium, Inc.
pci@0000:51:02.4  ens2f0v4    network        Cavium, Inc.



When carrier is activated RU waits showing "RRH_state=INIT" for 3 mins, do not panic and patiently wait until RU goes to state 2. 

Use this command to check status of RU from the DU

/data/confd-basic-7.3.3.linux.x86_64/confd/bin/netconf-console --host=192.168.0.2 --user=root --pass=root --port=830 --get -x /user-plane-configuration/tx-array-carriers

To deactivate carrier, use below command

/data/confd-basic-7.3.3.linux.x86_64/confd/bin/netconf-console --host=192.168.0.2 --port=830 --user=root --pass=root --edit-config /etc/gnb/mplane/deactivate_carriers.xml
